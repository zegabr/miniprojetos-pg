<!DOCTYPE html>
<html>
 <head>
  <script type="application/javascript">
  class Curva{
    constructor(){
      //pontos de controle (poligono de controle são as retas entre pontos consecutivos)
      this.px=[];
      this.py=[];

      //pontos da curva (curva são retas geradas entre esses pontos)
      this.cx=[];
      this.cy=[];
    }
    bezier(index,r,t,arr){
      if(r == 0){
        return arr[index];
      } else {
        return ((1-t)*bezier(index,r-1,t,arr)) + (t*bezier(index+1,r-1,t,arr));
      }
    }
    createcurve(numerodeavaliacoes){
      for(var t=0; t<=1;t+=1/numerodeavaliacoes){
        this.cx.push(bezier(0,px.length,t,px));
        this.cy.push(bezier(0,py.length,t,py));
      }
    }
  }
  var todasCurvas = [];//array da classe Curva
  var curvaAtual = 0;//indicador da curva atual

    function setPoint() {
      var canvas = document.getElementById("canvas");
      if (canvas.getContext) {
        var ctx = canvas.getContext("2d");
        canvas.onclick = function(evt){
          var rectNav = canvas.getBoundingClientRect();
          var x = evt.clientX;
          var y = evt.clientY;
          
          if(todasCurva.length == 0){
            todasCurva.push(new Curva());
          }

          todasCurva[curvaAtual].px.push(x);
          todasCurva[curvaAtual].py.push(y);
          

          // alert("aqui1");
          //atualizar();
          // alert("aqui2");

        }
      }
    }
    function atualizar(){
      var canvas = document.getElementById("canvas");
      if (canvas.getContext) {
        var ctx = canvas.getContext("2d");

        ctx.strokeStyle = "#FFFFFF"; // BRANCO
        ctx.beginPath(); //pra começar uma nova figura geometrica
        ctx.fillRect(0, 0, 750, 500);
        ctx.stroke();
        
        
        
        var a = CheckBox("pontoControle");
        var b = CheckBox("poligonoControle");
        var c = CheckBox("curvaControle");
        if(a){
            //desenhar pontos
            for(i=0; i<todasCurva.length; i++){
              todasCurvas[i].createcurve(numAvaliacoes);
              for(j=0; j<todasCurva[i].px.length; j++){
                ctx.strokeStyle = "#000000"; //PRETO
                ctx.beginPath(); //pra começar uma nova figura geometrica
                ctx.arc(todasCurva[i].px[j]-425,todasCurva[i].py[j]-10,3,0,2*Math.PI); //ctx.arc(x, y, radius, startAngle, endAngle, anticlockwise); -425 e -10 porque o quadro ta no meio da tela
                ctx.stroke();
              }
            }
        }
        if(b){
            //desenha retas
            // for(i=0; i<todasCurva.length; i++){
            //   for(j=1; j<todasCurva[i].px.length; j++){
            //     ctx.strokeStyle = "#000000"; //preto
            //     ctx.moveTo(todasCurva[i].pointx[ix-1]-425, todasCurva[i].pointy[iy-1]-10); //move o eixo
            //     ctx.lineTo(pointx[ix]-425-1, pointy[iy]-10-1); //cria a linha do eixo até aí
            //     ctx.stroke();
            //   }
            // }
        }
        if(c){
          // for(i=0; i<todasCurva.length; i++){
              // todasCurvas[i].createcurve(numAvaliacoes);
              //desenhar curvas (retas entre pontos consecutivos cx e cy da curvaatual)
              // for(j=1; j<todasCurva[i].px.length; j++){
              //   ctx.strokeStyle = "#000000"; //preto
              //   ctx.moveTo(todasCurva[i].pointx[ix-1]-425, todasCurva[i].pointy[iy-1]-10); //move o eixo
              //   ctx.lineTo(pointx[ix]-425-1, pointy[iy]-10-1); //cria a linha do eixo até aí
              //   ctx.stroke();
              // }
          // }
        }
      }
    }
    function CheckBox(nome){
      var canvas = document.getElementById("canvas");
      if (canvas.getContext) {
        var ctx = canvas.getContext("2d");
        var check = document.getElementsByName(nome); 
        return check[0].checked;
      }
    }
    
    function draw0(){
      var canvas = document.getElementById("canvas");
      if (canvas.getContext) {
        var ctx = canvas.getContext("2d");
          

      }
    }
    function bezier(t, arr, r, index){
    if(r == 0){
      return arr[index];
    } else {
      return ((1-t)*bezier(t,arr,r-1,index)) + (t*bezier(t,arr,r-1,index+1))
    }
  } 
  </script>
 </head>
 <body>
  <center><canvas id="canvas" width="750" height="500" style = "border: 3px solid#000000;"></canvas></center>
  <p>
       <button onclick="setPoint()">Inserir Pontos</button>
       <button onclick="draw0()">Nova Curva</button>
       <button onclick="draw1()">Deletar Curva</button>
       <button onclick="draw2()">Curva Anterior</button>
       <button onclick="draw3()">Proxima Curva</button>
   </p>
       <input type="checkbox" name="pontoControle" checked> Pontos de Controle<br>
       <input type="checkbox" name="poligonoControle" checked> Poligonais de Controle<br>
       <input type="checkbox" name="curvaControle" checked> Curvas<br><br>
       <button onclick="atualizar()">Sicronizar</button>
</body>
</html>